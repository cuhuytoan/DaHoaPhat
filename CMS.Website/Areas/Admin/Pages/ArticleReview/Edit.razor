@page "/Admin/ArticleReview/Edit"

<div class="row">
    <div class="col-sm-12">
        <div class="white-box">
            <h3 class="box-title m-b-0">Cập nhật đợt phản biện</h3>
            <p class="text-muted m-b-30 font-13"> Cập nhật chi tiết đợt phản biện </p>            
            <EditForm Model="articleReviewModel" OnValidSubmit="@OnPostArticleReview">
                <DataAnnotationsValidator />

                <input type="hidden" class="form-control" @bind="articleReviewModel.ArticleReview.Id">
                <div class="form-group row">
                    <button type="submit" class="btn btn-mat btn-success m-r-10 m-b-10" style="color: #FFFFFF;"><i class="fa fa-save"></i>Lưu</button>
                    <a class="btn btn-mat btn-warning m-r-10 m-b-10" style="color: #FFFFFF;" href="/Admin/ArticleReview/Index"><i class="fa fa-times-circle"></i>Trở về</a>
                </div>
                <div class="form-group row">
                    <div class="col-sm-12">
                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Tên đợt phản biện</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" @bind="articleReviewModel.ArticleReview.Name" placeholder="Nhập tên đợt phản biện">
                                <span class="text-danger"><ValidationMessage For="() => articleReviewModel.ArticleReview.Name" /></span>
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Mô tả ngắn</label>
                            <div class="col-sm-10">
                                <textarea type="text" style="height: 150px;" class="form-control" @bind="articleReviewModel.ArticleReview.Description" placeholder="Nhập mô tả ngắn"></textarea>
                                <span class="text-danger"><ValidationMessage For="() => articleReviewModel.ArticleReview.Description" /></span>
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Bắt đầu</label>
                            <div class="col-sm-4">
                                <TelerikDatePicker @bind-Value="articleReviewModel.ArticleReview.StartDate"></TelerikDatePicker>
                                <span class="text-danger"><ValidationMessage For="() => articleReviewModel.ArticleReview.StartDate" /></span>
                            </div>
                            <label class="col-sm-3 col-form-label" style="text-align: right;">Ngày kết thúc</label>
                            <div class="col-sm-3">
                                <div style="float: right">
                                    <TelerikDatePicker @bind-Value="articleReviewModel.ArticleReview.EndDate"></TelerikDatePicker>
                                    <span class="text-danger"><ValidationMessage For="() => articleReviewModel.ArticleReview.EndDate" /></span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Danh sách người phản biện</label>
                            <div class="col-sm-10">
                                <table id="simpletable" class="table table-styling" role="grid" aria-describedby="simpletable_info">
                                    <thead>
                                        <tr>
                                            <th style="width:50px;display:none;">
                                            </th>
                                            <th style="width:50px;">
                                                Email
                                            </th>
                                            <th style="width:50px;">
                                                Họ tên
                                            </th>
                                            <th style="width:50px;">
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @if (lstArticleReviewPerson == null)
                                        {
                                            <p><em>Loading...</em></p>
                                        }
                                        else
                                        {
                                            @foreach (var p in lstArticleReviewPerson)
                                            {
                                                <tr>
                                                    <td style="width:50px;display:none;">
                                                    </td>
                                                    <td>
                                                        @p.Email
                                                    </td>
                                                    <td>
                                                        @p.FullName
                                                    </td>
                                                    <td>
                                                        <a @onclick="() => OnRemoveArticleReviewPerson(p)"><i class="fa fa-trash"></i></a>
                                                    </td>
                                                </tr>
                                            }
                                        }

                                    </tbody>
                                </table>
                                <div class="row" style="display:flex;">
                                    <TelerikAutoComplete Data="@lstAccountSearchResult"
                                                         @bind-Value="@selectedUser"
                                                         Placeholder="Nhập email người phản biện..."
                                                         Id="state-autocomplete"
                                                         Width="100%">

                                    </TelerikAutoComplete>
                                    <a class="btn btn-mat btn-success m-l-10" style="color: #FFFFFF;" @onclick="@(() => OnAddArticleReviewPerson())"><i class="fa fa-play"></i>Thêm</a>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Danh sách bài viết phản biện</label>
                            <div class="col-sm-10">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th style="width:100px;">
                                                </th>
                                                <th>
                                                    Tiêu đề
                                                </th>
                                               
                                                <th style="width:50px;">
                                                </th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            @if (lstArticleSelected == null)
                                            {
                                                <p><em>Loading...</em></p>
                                            }
                                            else
                                            {
                                                @foreach (var item in lstArticleSelected)
                                                {
                                                    <tr>
                                                        <td>
                                                            <img src="/data/article/mainimages/small/@item.Image" />
                                                        </td>
                                                        <td>
                                                            <div style="font-weight: 700;">
                                                                <a href="/Admin/Article/Edit?articleId=@item.Id">
                                                                    @item.Name
                                                                </a>
                                                            </div>
                                                            <div>
                                                                Đăng bởi <b>@item.CreateByName</b> vào lúc
                                                                <b>@item.CreateDate.Value.ToString("dd/MM/yyyy HH:mm")</b>
                                                            </div>
                                                            <div>
                                                                Chuyên mục: <span style="font-weight: 700; color: #0094ff;">@item.ArticleCategoryName</span>
                                                            </div>
                                                        </td>                                                        
                                                        <td style="text-align: center; padding-top: 30px;">                                                           
                                                            <a @onclick="() => OnRemmoveArticleReviewArticle(item)"><i class="fa fa-trash"></i></a>
                                                        </td>

                                                    </tr>
                                                }
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-2 col-form-label">Danh sách bài viết đã sơ duyệt</label>
                            <div class="col-sm-10">                             
                                <InputText class="form-control m-r-10 m-b-10" type="search" @bind-Value="@keyword" placeholder="Từ khóa tìm kiếm..." />
                                <a class="btn btn-mat btn-success m-r-10 m-b-10" @onclick="() => OnSearchArticle(keyword)" style="color: #FFFFFF;"><i class="fa fa-search"></i>Tìm kiếm</a>
                            </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12 col-sm-12 col-md-12">
                                    <div class="white-box">
                                        <div class="table-responsive">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th style="width:100px;">
                                                        </th>
                                                        <th>
                                                            Tiêu đề
                                                        </th>
                                                        <th style="width:50px;">
                                                            Trạng thái
                                                        </th>
                                                        <th style="width:50px;">
                                                        </th>

                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @if (lstArticle == null)
                                                    {
                                                        <p><em>Loading...</em></p>
                                                    }
                                                    else
                                                    {
                                                        @foreach (var item in lstArticle)
                                                        {
                                                            <tr>
                                                                <td>
                                                                    <img src="/data/article/mainimages/small/@item.Image" />
                                                                </td>
                                                                <td>
                                                                    <div style="font-weight: 700;">
                                                                        <a href="/Admin/Article/Edit?articleId=@item.Id">
                                                                            @item.Name
                                                                        </a>
                                                                    </div>
                                                                    <div>
                                                                        Đăng bởi <b>@item.CreateByName</b> vào lúc
                                                                        <b>@item.CreateDate.Value.ToString("dd/MM/yyyy HH:mm")</b>
                                                                    </div>
                                                                    <div>
                                                                        Chuyên mục: <span style="font-weight: 700; color: #0094ff;">@item.ArticleCategoryName</span>
                                                                    </div>
                                                                </td>
                                                                <td>
                                                                    <div style="margin-top: 20px; text-align: center;">
                                                                        @{
                                                                            string styleStatus = "badge-success";
                                                                            if (item.ArticleStatusId == 0)
                                                                            {
                                                                                styleStatus = "badge-info";
                                                                            }
                                                                            else if (item.ArticleStatusId == 1)
                                                                            {
                                                                                styleStatus = "badge-warning";
                                                                            }
                                                                        }
                                                                        <label class='badge @styleStatus'> @item.StatusName</label>
                                                                    </div>
                                                                </td>
                                                                <td style="text-align: center; padding-top: 30px;">
                                                                    <a href="/Admin/Article/Preview?articleId=@item.Id">
                                                                        <i class="fa fa-eye" style="color: #0094ff;"></i>
                                                                    </a>
                                                                    <a @onclick="() => OnAddArticleReviewArticle(item)"><i class="fa fa-plus-circle"></i></a>
                                                                </td>

                                                            </tr>
                                                        }
                                                    }
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                </div>

            </EditForm>


        </div>
    </div>
</div>
